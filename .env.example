# SentinelForge Configuration
# Copy this file to .env and fill in your values

# ===========================
# Database Configuration
# ===========================
POSTGRES_USER=sentinelforge_user
POSTGRES_PASSWORD=change_me_in_production
POSTGRES_DB=sentinelforge

# NOTE: The API uses the async driver (postgresql+asyncpg://), while the worker uses the sync driver (postgresql://).
# docker-compose.yml overrides these with internal container hostnames, so these defaults only matter for local dev.
DATABASE_URL=postgresql+asyncpg://sentinelforge_user:change_me_in_production@postgres:5432/sentinelforge
DATABASE_URL_SYNC=postgresql://sentinelforge_user:change_me_in_production@postgres:5432/sentinelforge

# ===========================
# Object Storage (MinIO/S3)
# ===========================
S3_ENDPOINT=http://minio:9000
S3_ACCESS_KEY=minioadmin
S3_SECRET_KEY=minioadmin
S3_BUCKET=sentinelforge-artifacts
S3_REGION=us-east-1

# For AWS S3 instead of MinIO, use:
# S3_ENDPOINT=https://s3.amazonaws.com
# S3_ACCESS_KEY=your_aws_access_key
# S3_SECRET_KEY=your_aws_secret_key

# ===========================
# Authentication & Security
# ===========================
# REQUIRED: Generate with `python -c "import secrets; print(secrets.token_hex(32))"`
JWT_SECRET_KEY=CHANGE_ME_GENERATE_A_RANDOM_256_BIT_KEY
JWT_ALGORITHM=HS256
JWT_EXPIRATION_MINUTES=30

# REQUIRED: Set strong admin credentials (12+ chars, mixed case, numbers, symbols)
DEFAULT_ADMIN_USERNAME=sf_admin
DEFAULT_ADMIN_PASSWORD=CHANGE_ME_USE_STRONG_PASSWORD

# CORS: Explicit origins only (no wildcards in production)
CORS_ORIGINS=["https://yourdomain.com"]

# OIDC Configuration (optional, for enterprise SSO)
OIDC_ENABLED=false
OIDC_ISSUER=
OIDC_CLIENT_ID=
OIDC_CLIENT_SECRET=

# ===========================
# Model Provider API Keys
# ===========================
# OpenAI
OPENAI_API_KEY=

# Anthropic
ANTHROPIC_API_KEY=

# Azure OpenAI
AZURE_OPENAI_API_KEY=
AZURE_OPENAI_ENDPOINT=
AZURE_OPENAI_DEPLOYMENT_NAME=

# AWS Bedrock
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1

# Databricks (config placeholder — no adapter yet)
# DATABRICKS_HOST=
# DATABRICKS_TOKEN=

# HuggingFace
HUGGINGFACE_API_TOKEN=

# ===========================
# Redis (token blocklist)
# ===========================
# Leave empty for in-memory fallback (single-instance only)
REDIS_URL=redis://redis:6379/0

# ===========================
# Observability
# ===========================
# OpenTelemetry
OTEL_EXPORTER_OTLP_ENDPOINT=http://jaeger:4318
OTEL_SERVICE_NAME=sentinelforge

# Logging
LOG_LEVEL=info
LOG_FORMAT=json

# Metrics
PROMETHEUS_PORT=9090
METRICS_ENABLED=true

# ===========================
# Worker Configuration
# ===========================
WORKER_CONCURRENCY=10
WORKER_TIMEOUT_SECONDS=3600
WORKER_MAX_RETRIES=3

# ===========================
# Budget Constraints
# ===========================
DEFAULT_TOKEN_LIMIT=100000
DEFAULT_COST_LIMIT_USD=50
DEFAULT_TIME_LIMIT_SECONDS=3600

# ===========================
# Evidence & Security
# ===========================
EVIDENCE_RETENTION_DAYS=90
EVIDENCE_REDACTION_PATTERNS=API_KEY_.*,sk-[a-zA-Z0-9]+,Bearer\\s+[a-zA-Z0-9]+

# ===========================
# Tools Configuration
# ===========================
TOOLS_REGISTRY_PATH=/opt/sentinelforge/tools/registry.yaml
TOOLS_ISOLATION_MODE=venv  # venv or container

# ===========================
# Features Flags
# ===========================
ENABLE_AGENT_TESTING=true
ENABLE_MULTI_TURN=true
ENABLE_SYNTHETIC_DATA=true
ENABLE_DRIFT_MONITORING=true
ENABLE_BACKDOOR_DETECTION=true
ENABLE_SUPPLY_CHAIN_SCAN=true
ENABLE_SCHEDULED_SCANS=true
ENABLE_COMPLIANCE=true

# ===========================
# Rate Limiting (v1.5)
# ===========================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_DEFAULT=100/minute

# ===========================
# Scheduled Scans (v1.5)
# ===========================
# Cron-based recurring scans are polled by the worker.
# No extra config needed — schedules are created via POST /schedules.

# ===========================
# Notification Channels (v1.5)
# ===========================
# SMTP (email notifications)
SMTP_HOST=
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM=noreply@sentinelforge.io

# Slack notifications: configure via POST /notifications/channels
# Teams notifications: configure via POST /notifications/channels

# ===========================
# Compliance (v1.6)
# ===========================
# PDF reports require weasyprint. Installed in the API Docker image.
# Frameworks: OWASP ML Top 10, NIST AI RMF, EU AI Act

# ===========================
# Dashboard UI (v2.0)
# ===========================
NEXT_PUBLIC_API_URL=http://localhost:8000
CORS_ORIGINS=["http://localhost:3001"]

# ===========================
# Development
# ===========================
DEBUG=false
RELOAD=false  # Auto-reload on code changes (dev only)

# ===========================
# Production
# ===========================
# SBOM & Image Signing
SBOM_ENABLED=true
IMAGE_SIGNING_ENABLED=true
COSIGN_KEY=/path/to/cosign.key

# Vulnerability Scanning
VULNERABILITY_SCAN_ENABLED=true
VULNERABILITY_SCAN_ON_STARTUP=true
